(this["webpackJsonpreact-admin_client"]=this["webpackJsonpreact-admin_client"]||[]).push([[0],{436:function(e,t,n){},531:function(e,t,n){},533:function(e,t,n){},534:function(e,t,n){},535:function(e,t,n){},944:function(e,t,n){},952:function(e,t,n){},953:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(35),c=n.n(s),i=n(66),o=n(180),u=n(398),l=n(58),d=n(245),p=n.n(d),h="user_key",j=function(e){p.a.set(h,e)},m=function(){p.a.remove(h)};var b="set_head_title",f="receive_user",O="show_error_msg",g="reset_user";var x=function(){return p.a.get(h)||{}}();var y,v=(y={headTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return t.data;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.user;case O:var n=t.errorMsg;return Object(l.a)(Object(l.a)({},e),{},{errorMsg:n});case g:return{};default:return e}}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=Object.keys(y).reduce((function(n,r){return n[r]=y[r](e[r],t),n}),{});return n}),w=n(399),k=Object(o.createStore)(v,Object(w.composeWithDevTools)(Object(o.applyMiddleware)(u.a))),S=n(21),C=n(22),N=n(24),I=n(23),A=n(105),P=n(46),_=(n(62),n(29)),R=(n(290),n(139)),T=(n(127),n(42)),q=(n(111),n(44)),U=n(18),F=n.n(U),M=n(32),D=(n(436),n.p+"static/media/logo.f6487143.png"),E=n(100),L=(n(112),n(38)),V=n(284),W=n.n(V);function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(r,a){("GET"===n?W.a.get(e,{params:t}):W.a.post(e,t)).then((function(e){r(e.data)})).catch((function(e){L.b.error("\u8bf7\u6c42\u51fa\u9519"+e.message)}))}))}var K=n(402),z=n.n(K),H={reqLogin:function(e,t){return B("/api/login",{username:e,password:t},"POST")},reqAddUser:function(e){return B("/api/manage/user/add",e,"POST")},reqWeather:function(){return new Promise((function(e,t){z()("https://restapi.amap.com/v3/weather/weatherInfo?city=420100&key=10bf3cbb5656059a6e2462481330f976",{},(function(t,n){if(t||"OK"!==n.info)L.b.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25");else{var r=n.lives[0].weather;e(r)}}))}))},reqCategorys:function(e){return B("/api/manage/category/list",{parentId:e},"GET")},reqAddCategory:function(e,t){return B("/api/manage/category/add",{categoryName:e,parentId:t},"POST")},reqUpdateCategory:function(e,t){return B("/api/manage/category/update",{categoryId:e,categoryName:t},"POST")},reqCategory:function(e){return B("/api/manage/category/info",{categoryId:e},"GET")},reqProducts:function(e,t){return B("/api/manage/product/list",{pageNum:e,pageSize:t},"GET")},reqUpdateStatus:function(e,t){return B("/api/manage/product/updateStatus",{productId:e,status:t},"POST")},reqSearchProduct:function(e){var t=e.pageNum,n=e.pageSize,r=e.searchName,a=e.searchType;return B("/api/manage/product/search",Object(E.a)({pageNum:t,pageSize:n},a,r),"GET")},reqDeleteImg:function(e){return B("/api/manage/img/delete",{name:e},"POST")},reqAddOrUpdateProduct:function(e){return B("/api/manage/product/"+(e._id?"update":"add"),e,"POST")},reqRoles:function(){return B("/api/manage/role/list")},reqAddRole:function(e){return B("/api/manage/role/add",{roleName:e},"POST")},reqUpdateRole:function(e){return B("/api/manage/role/update",e,"POST")},reqUsers:function(){return B("/api/manage/user/list")},reqDeleteUser:function(e){return B("/api/manage/user/delete",{userId:e},"POST")},reqAddOrUpdateUser:function(e){return B("/api/manage/user/"+(e._id?"update":"add"),e,"POST")}},J=function(e){return{type:b,data:e}},G=function(e){return{type:f,user:e}},X=function(){return m(),{type:g}},Q=n(5),Z=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onFinish=function(){var t=Object(M.a)(F.a.mark((function t(n){var r,a;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.username,a=n.password,e.props.login(r,a);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFinishFailed=function(e,t,n){e.errorFields.map((function(e){return console.log(e.errors)}))},e}return Object(C.a)(n,[{key:"render",value:function(){var e=this.props.user;if(e&&e._id)return Object(Q.jsx)(P.a,{to:"/home"});var t=this.props.user.errorMsg,n={wrapperCol:{offset:80,span:10}};return Object(Q.jsxs)("div",{className:"login",children:[Object(Q.jsxs)("header",{className:"login-header",children:[Object(Q.jsx)("img",{src:D,alt:"logo"}),Object(Q.jsx)("h1",{children:"react project\uff1a Backstage Management System "})]}),Object(Q.jsxs)("section",{className:"login-content",children:[Object(Q.jsxs)("div",{children:[t," "]}),Object(Q.jsx)("h2",{children:"User Login"}),Object(Q.jsxs)(T.a,Object(l.a)(Object(l.a)({},{labelCol:{span:80},wrapperCol:{span:30}}),{},{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,children:[Object(Q.jsx)(T.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c114\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u4e0d\u80fd\u8d85\u8fc712\u4f4d"},{pattern:/[!^a-zA-Z0-9_]+$/,message:"\u5fc5\u987b\u662f\u82f1\u6587.\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}],children:Object(Q.jsx)(q.a,{})}),Object(Q.jsx)(T.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"},{min:4,message:"\u5bc6\u7801\u81f3\u5c114\u4f4d"},{max:12,message:"\u5bc6\u7801\u4e0d\u80fd\u8d85\u8fc712\u4f4d"},{pattern:/[!^a-zA-Z0-9_]+$/,message:"\u5fc5\u987b\u662f\u82f1\u6587.\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}],children:Object(Q.jsx)(q.a,{})}),Object(Q.jsx)(T.a.Item,Object(l.a)(Object(l.a)({},n),{},{name:"remember",valuePropName:"checked",children:Object(Q.jsx)(R.a,{children:"Remember me"})})),Object(Q.jsx)(T.a.Item,Object(l.a)(Object(l.a)({},n),{},{children:Object(Q.jsx)(_.a,{type:"primary",htmlType:"submit",className:"login-form-buttom",children:"Submit"})}))]}))]})]})}}]),n}(r.Component),$=Object(i.b)((function(e){return{user:e.user}}),{login:function(e,t){return function(){var n=Object(M.a)(F.a.mark((function n(r){var a,s,c;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H.reqLogin(e,t);case 2:0===(a=n.sent).status?(s=a.data,j(s),r(G(s))):(c=a.msg,r({type:O,errorMsg:c}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}})(Z),Y=(n(527),n(163)),ee=(n(529),n(93)),te=n(959),ne=n(960),re=n(412),ae=n(961),se=n(962),ce=n(963),ie=n(964),oe=n(965),ue=n(966),le=n(967),de=[{title:"home",key:"/home",icon:Object(Q.jsx)(te.a,{}),isPublic:!0},{title:"product",key:"/products",icon:Object(Q.jsx)(ne.a,{}),children:[{title:"category",key:"/category",icon:Object(Q.jsx)(re.a,{})},{title:"product management",key:"/product",icon:Object(Q.jsx)(ae.a,{})}]},{title:"user management",key:"/user",icon:Object(Q.jsx)(se.a,{})},{title:"role management",key:"/role",icon:Object(Q.jsx)(ce.a,{})},{title:"charts",key:"/charts",icon:Object(Q.jsx)(ie.a,{}),children:[{title:"bar",key:"/charts/bar",icon:Object(Q.jsx)(oe.a,{})},{title:"line",key:"/charts/line",icon:Object(Q.jsx)(ue.a,{})},{title:"pie",key:"/charts/pie",icon:Object(Q.jsx)(le.a,{})}]}],pe=(n(531),ee.a.SubMenu),he=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).hasAuth=function(t){var n=t.key,r=e.props.user.role.menus;return!("admin"!==e.props.user.username&&!t.isPublic&&-1===r.indexOf(n))||!!t.children&&!!t.children.find((function(e){return-1!==r.indexOf(e.key)}))},e.getMenuNodes=function(t){var n=e.props.location.pathname;return t.map((function(t){return e.hasAuth(t)?t.children?(t.children.find((function(e){return 0===n.indexOf(e.key)}))&&(e.openKey=t.key),Object(Q.jsx)(pe,{icon:t.icon,title:t.title,children:e.getMenuNodes(t.children)},t.key)):(t.key!==n&&0!==n.indexOf(t.key)||e.props.setHeadTitle(t.title),Object(Q.jsx)(ee.a.Item,{icon:t.icon,children:Object(Q.jsx)(A.b,{to:t.key,onClick:function(){return e.props.setHeadTitle(t.title)},children:t.title})},t.key)):0}))},e}return Object(C.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(de)}},{key:"render",value:function(){var e=this.props.location.pathname;console.log("render()",e),0===e.indexOf("/product")&&(e="/product");var t=this.openKey;return Object(Q.jsx)("div",{children:Object(Q.jsxs)("div",{className:"left-nav",children:[Object(Q.jsxs)(A.b,{to:"/",className:"left-nav-header",children:[Object(Q.jsx)("img",{src:D,alt:"logo"}),Object(Q.jsx)("h1",{children:"\u7845\u8c37\u540e\u53f0"})]}),Object(Q.jsx)(ee.a,{mode:"inline",theme:"dark",defaultOpenKeys:[t],selectedKeys:[e],children:this.menuNodes})]})})}}]),n}(r.Component),je=Object(i.b)((function(e){return{user:e.user}}),{setHeadTitle:J})(Object(P.g)(he)),me=(n(167),n(77)),be=n(185),fe=n(968),Oe=(n(533),function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return Object(Q.jsx)("button",Object(l.a)(Object(l.a)({},this.props),{},{className:"link-button"}))}}]),n}(r.Component));function ge(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}n(534);var xe=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={currentTime:ge(Date.now()),weather:""},e.getTime=function(){e.intervalId=setInterval((function(){var t=ge(Date.now());e.setState({currentTime:t})}),1e3)},e.getWeather=Object(M.a)(F.a.mark((function t(){var n,r;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.reqWeather("\u4e0a\u6d77");case 2:n=t.sent,r=n.weather,e.setState({weather:r});case 5:case"end":return t.stop()}}),t)}))),e.getTitle=function(){var t,n=e.props.location.pathname;return de.forEach((function(e){if(e.key===n)t=e.title;else if(e.children){var r=e.children.find((function(e){return e.key===n}));r&&(t=r.title)}})),t},e.logout=function(){me.a.confirm({title:"Confirm",icon:Object(Q.jsx)(be.a,{}),content:"Are you sure you want to exit?",onOk:function(){e.props.logout()},onCancel:function(){console.log("Cancel")}})},e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.getTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,n=e.weather,r=this.props.user.username,a=this.props.headTitle;return Object(Q.jsxs)("div",{className:"header",children:[Object(Q.jsxs)("div",{className:"header-top",children:[Object(Q.jsxs)("span",{children:[" Welcome\uff0c",r," "]}),Object(Q.jsx)(Oe,{onClick:this.logout,children:"Logout"})]}),Object(Q.jsxs)("div",{className:"header-bottom",children:[Object(Q.jsx)("div",{className:"header-bottom-left",children:a}),Object(Q.jsxs)("div",{className:"header-bottom-right",children:[Object(Q.jsx)("span",{children:t}),Object(Q.jsx)(fe.a,{style:{width:"30px",height:"20px",margin:"15 15 15 15"}}),Object(Q.jsx)("span",{children:n})]})]})]})}}]),n}(r.Component),ye=Object(i.b)((function(e){return{headTitle:e.headTitle,user:e.user}}),{logout:X})(Object(P.g)(xe)),ve=(n(535),function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return Object(Q.jsx)("div",{className:"home",children:"Welcome to use Backstage Management System"})}}]),n}(r.Component)),we=(n(104),n(47)),ke=(n(214),n(121)),Se=n(969),Ce=n(413),Ne=(n(195),n(68)),Ie=Ne.a.Option,Ae=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).formRef=a.a.createRef(),e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.props.setForm(this.formRef.current)}},{key:"render",value:function(){return Object(Q.jsxs)(T.a,{ref:this.formRef,children:[Object(Q.jsxs)(T.a.Item,{children:[Object(Q.jsx)("p",{children:"category:"}),Object(Q.jsx)(T.a.Item,{noStyle:!0,name:"parentId",initialValue:this.props.parentId,children:Object(Q.jsxs)(Ne.a,{value:this.props.parentId,style:{width:"100%"},children:[Object(Q.jsx)(Ie,{value:"0",children:"first category"}),this.props.categorys.map((function(e){return Object(Q.jsx)(Ie,{value:e._id,children:e.name},e._id)}))]})})]}),Object(Q.jsxs)(T.a.Item,{children:[Object(Q.jsx)("p",{children:"category name:"}),Object(Q.jsx)(T.a.Item,{noStyle:!0,name:"categoryName",rules:[{required:!0,message:"category name required"}],children:Object(Q.jsx)(q.a,{placeholder:"Please enter category name"})})]})]})}}]),n}(r.Component),Pe=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).formRef=a.a.createRef(),e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.props.setForm(this.formRef.current)}},{key:"render",value:function(){var e=this.props.categoryName;return Object(Q.jsx)(T.a,{ref:this.formRef,children:Object(Q.jsx)(T.a.Item,{name:"categoryName",initialValue:e,rules:[{required:!0,message:"categart name required"}],children:Object(Q.jsx)(q.a,{placeholder:"please enter categary name"})})})}}]),n}(r.Component),_e=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={loading:!1,categorys:[],subCategorys:[],parentId:"0",parentName:"",showStatus:0},e.initColumns=function(){return e.columns=[{title:"Category name",dataIndex:"name"},{title:"Management",width:500,dataIndex:"",key:"x",render:function(t){return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(Oe,{onClick:function(){e.showUpdate(t)},children:"update category"}),"0"===e.state.parentId?Object(Q.jsx)(Oe,{onClick:function(){e.showSubCategorys(t)},children:"showSubCategorys"}):null]})}}]},e.getCategorys=function(){var t=Object(M.a)(F.a.mark((function t(n){var r;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=n||e.state.parentId,e.setState({loading:!0}),t.next=4,H.reqCategorys(n);case 4:r=t.sent,e.setState({loading:!1}),0===r.status?"0"===n?e.setState({categorys:r.data}):e.setState({subCategorys:r.data}):L.b.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showSubCategorys=function(t){e.setState({parentId:t._id,parentName:t.name},(function(){e.getCategorys()}))},e.showCategorys=function(){e.setState({parentId:"0",parentName:"",subCategorys:[]})},e.handleCancel=function(){e.form.resetFields(),e.setState({showStatus:0})},e.showAdd=function(){e.setState({showStatus:1})},e.addCategory=Object(M.a)(F.a.mark((function t(){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.form.validateFields().then(function(){var t=Object(M.a)(F.a.mark((function t(n){var r,a;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({showStatus:0}),r=n.parentId,a=n.categoryName,e.form.resetFields(),t.next=5,H.reqAddCategory(a,r);case 5:0===t.sent.status&&(r===e.state.parentId?e.getCategorys():"0"===r&&e.getCategorys("0"));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){L.b.info("\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0")}));case 1:case"end":return t.stop()}}),t)}))),e.showUpdate=function(t){e.category=t,e.setState({showStatus:2})},e.updateCategory=function(){e.form.validateFields().then(function(){var t=Object(M.a)(F.a.mark((function t(n){var r,a;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({showStatus:0}),r=e.category._id,a=n.categoryName,e.form.resetFields(),t.next=6,H.reqUpdateCategory(r,a);case 6:0===t.sent.status&&e.getCategorys();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){L.b.info("\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0")}))},e}return Object(C.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=Object(Q.jsx)(_.a,{type:"primary",icon:Object(Q.jsx)(Ce.a,{}),onClick:this.showAdd,children:"add"}),n=this.state,r=n.categorys,a=n.subCategorys,s=n.parentId,c=n.parentName,i=n.loading,o=n.showStatus,u=this.category||{name:""},l="0"===s?"first class list":Object(Q.jsxs)("span",{children:[Object(Q.jsx)(Oe,{onClick:this.showCategorys,children:"first class list"}),Object(Q.jsx)(Se.a,{style:{marginRight:5}}),Object(Q.jsx)("span",{children:c})]});return Object(Q.jsxs)(we.a,{title:l,extra:t,children:[Object(Q.jsx)(ke.a,{dataSource:"0"===s?r:a,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{defaultPageSize:5,showQuickJumper:!0},loading:i}),";",1===o?Object(Q.jsx)(me.a,{title:"Add category",visible:1===o,onOk:this.addCategory,onCancel:this.handleCancel,children:Object(Q.jsx)(Ae,{categorys:r,parentId:s,setForm:function(t){return e.form=t}})}):null,2===o?Object(Q.jsx)(me.a,{title:"Update category",visible:2===o,onOk:this.updateCategory,onCancel:this.handleCancel,children:Object(Q.jsx)(Pe,{categoryName:u.name,setForm:function(t){return e.form=t}})}):null]})}}]),n}(r.Component),Re=n(970),Te="http://localhost:5000/upload/",qe=Ne.a.Option,Ue=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={total:0,products:[],loading:!1,searchName:"",searchType:"productName"},e.initColumns=function(){var t;e.columns=[{title:"Product Name",dataIndex:"name"},{title:"Product Describe",dataIndex:"desc"},{title:"Price",dataIndex:"price",render:function(e){return"$"+e}},{width:100,title:"Status",render:function(t){var n=t.status,r=t._id;return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(_.a,{type:"primary",onClick:function(){e.updateStatus(r,1===n?2:1)},children:1===n?"out of stock":"in stock"}),Object(Q.jsx)("span",{children:1===n?"available":"out of stock"})]})}},(t={width:100,title:"Management"},Object(E.a)(t,"width",150),Object(E.a)(t,"render",(function(t){return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(Oe,{onClick:function(){return e.props.history.push("/product/detail",{product:t})},children:"Detail"}),Object(Q.jsx)(Oe,{onClick:function(){return e.props.history.push("/product/addupdate",t)},children:"Edit"})]})})),t)]},e.getProducts=function(){var t=Object(M.a)(F.a.mark((function t(n){var r,a,s,c,i,o,u;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.pageNum=n,e.setState({laoding:!0}),r=e.state,a=r.searchName,s=r.searchType,!a){t.next=9;break}return t.next=6,H.reqSearchProduct({pageNum:n,pageSize:3,searchName:a,searchType:s});case 6:c=t.sent,t.next=12;break;case 9:return t.next=11,H.reqProducts(n,3);case 11:c=t.sent;case 12:e.setState({laoding:!1}),0===c.status&&(i=c.data,o=i.total,u=i.list,e.setState({total:o,products:u}));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateStatus=function(){var t=Object(M.a)(F.a.mark((function t(n,r){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.reqUpdateStatus(n,r);case 2:0===t.sent.status&&(L.b.success("product updated"),e.getProducts(e.pageNum));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(C.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.products,r=t.total,a=t.loading,s=t.searchType,c=t.searchName,i=Object(Q.jsxs)("span",{children:[Object(Q.jsxs)(Ne.a,{value:s,style:{width:130},onChange:function(t){return e.setState({searchType:t})},children:[Object(Q.jsx)(qe,{value:"productName",children:" By name"}),Object(Q.jsx)(qe,{value:"productDesc",children:" By description"})]}),Object(Q.jsx)("input",{placeholder:"Key words",style:{width:200,margin:"0 15px"},value:c,onChange:function(t){return e.setState({searchName:t.target.value})}}),Object(Q.jsx)(_.a,{type:"primary",onClick:function(){return e.getProducts(1)},children:" search "})]}),o=Object(Q.jsxs)(_.a,{type:"promary",onClick:function(){return e.props.history.push("/product/addupdate")},children:[Object(Q.jsx)(Re.a,{}),"Add Item"]});return Object(Q.jsx)(we.a,{title:i,extra:o,children:Object(Q.jsx)(ke.a,{bordered:!0,rowKey:"_id",loading:a,dataSource:n,columns:this.columns,pagination:{current:this.pageNum,total:r,defaultPageSize:3,showQuickJumper:!0,onChange:this.getProducts}})})}}]),n}(r.Component),Fe=(n(550),n(411)),Me=n(234),De=n(215),Ee=n(971),Le=(n(552),n(954),n(409)),Ve=n(116),We=n.n(Ve);function Be(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))}var Ke=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(e){var r;Object(S.a)(this,n),(r=t.call(this,e)).state={previewVisible:!1,previewImage:"",previewTitle:"",fileList:[]},r.getImgs=function(){return r.state.fileList.map((function(e){return e.name}))},r.handleCancel=function(){return r.setState({previewVisible:!1})},r.handlePreview=function(){var e=Object(M.a)(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Be(t.originFileObj);case 3:t.preview=e.sent;case 4:r.setState({previewImage:t.url||t.preview,previewVisible:!0,previewTitle:t.name||t.url.substring(t.url.lastIndexOf("/")+1)});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleChange=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,a,s,c,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,a=t.fileList,"done"!==n.status){e.next=6;break}0===(s=n.response).status?(L.b.success("upload sucess"),c=s.data,i=c.name,o=c.url,n.name=i,n.url=o):L.b.error("fail to upload"),e.next=11;break;case 6:if("removed"!==n.status){e.next=11;break}return e.next=9,H.reqDeleteImg(n.name);case 9:0===e.sent.status?L.b.success("picture deleted"):L.b.error("fail to delete picture");case 11:r.setState({fileList:a});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var a=[],s=r.props.imgs;return s&&s.length>0&&(a=s.map((function(e,t){return{uid:-t,name:e,status:"done",url:Te+e}}))),r.state={previewVisible:!1,previewImage:"",fileList:a},r}return Object(C.a)(n,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,n=e.previewImage,r=e.fileList,a=e.previewTitle,s=Object(Q.jsxs)("div",{children:[Object(Q.jsx)(Ce.a,{}),Object(Q.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Le.a,{action:"/manage/img/upload",accept:"image/*",name:"image",listType:"picture-card",fileList:r,onPreview:this.handlePreview,onChange:this.handleChange,children:r.length>=8?null:s}),Object(Q.jsx)(me.a,{visible:t,title:a,footer:null,onCancel:this.handleCancel,children:Object(Q.jsx)("img",{alt:"example",style:{width:"100%"},src:n})})]})}}]),n}(a.a.Component);Ke.propsTypes={imgs:We.a.array};var ze=n(135),He=n(405),Je=(n(941),n(406)),Ge=n.n(Je),Xe=n(407),Qe=n.n(Xe),Ze=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(e){var r;Object(S.a)(this,n),(r=t.call(this,e)).onEditorStateChange=function(e){r.setState({editorState:e})},r.getDetail=function(){return Ge()(Object(ze.convertToRaw)(r.state.editorState.getCurrentContent()))},r.uploadImageCallBack=function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.open("POST","/manage/img/upload"),r.setRequestHeader("Authorization","Client-ID XXXXX");var a=new FormData;a.append("image",e),r.send(a),r.addEventListener("load",(function(){var e=JSON.parse(r.responseText).data.url;t({data:{link:e}})})),r.addEventListener("error",(function(){var e=JSON.parse(r.responseText);n(e)}))}))};var a=r.props.detail;if(a){var s=Qe()(a);if(s){var c=ze.ContentState.createFromBlockArray(s.contentBlocks),i=ze.EditorState.createWithContent(c);r.state={editorState:i}}}else r.state={editorState:ze.EditorState.createEmpty()};return r}return Object(C.a)(n,[{key:"render",value:function(){var e=this.state.editorState;return Object(Q.jsx)(He.Editor,{editorState:e,editorStyle:{border:"1px solid black",minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}}})}}]),n}(r.Component),$e=T.a.Item,Ye=q.a.TextArea,et=[{value:"zhejiang",label:"Zhejiang",isLeaf:!1},{value:"jiangsu",label:"Jiangsu",isLeaf:!1}],tt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(e){var r;return Object(S.a)(this,n),(r=t.call(this,e)).state={options:[]},r.formRef=a.a.createRef(),r.initOptions=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,a,s,c,i,o,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),a=Object(De.a)(r),s=a.isUpdate,c=a.product,i=c.pCategoryId,c.categoryId,!s||"0"===i){e.next=10;break}return e.next=6,r.getCategorys(i);case 6:o=e.sent,u=o.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.find((function(e){return e.value===i})).children=u;case 10:r.setState({options:n});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.validatePrice=function(e,t){return 1*t>0?Promise.resolve():Promise.reject(new Error("price must above 0"))},r.getCategorys=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.reqCategorys(t);case 2:if(0!==(n=e.sent).status){e.next=10;break}if(a=n.data,"0"!==t){e.next=9;break}r.initOptions(a),e.next=10;break;case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.loadData=function(){var e=Object(M.a)(F.a.mark((function e(t){var n,a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,r.getCategorys(n.value);case 4:a=e.sent,n.loading=!1,a&&a.length>0?(s=a.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=s):n.isLeaf=!0,r.setState({options:Object(Me.a)(r.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.submit=function(){r.formRef.current.validateFields().then(function(){var e=Object(M.a)(F.a.mark((function e(t){var n,a,s,c,i,o,u,l,d;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.desc,s=t.price,1===(c=t.categoryIds).length?(o="0",i=c[0]):(o=c[0],i=c[1]),u=r.pw.current.getImgs(),l=r.editor.current.getDetail(),d={name:n,desc:a,price:s,imgs:u,detail:l,pCategoryId:o,categoryId:i},r.isUpdate&&(d._id=r.product._id),e.next=8,H.reqAddOrUpdateProduct(d);case 8:0===e.sent.status?(L.b.success("".concat(r.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u6210\u529f!")),r.props.history.goBack()):L.b.error("".concat(r.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u5931\u8d25!"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},r.pw=a.a.createRef(),r.editor=a.a.createRef(),r}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props.location.state;this.isUpdate=!!e,this.product=e||{}}},{key:"render",value:function(){var e=this,t=this.isUpdate,n=this.product,r=Object(Q.jsxs)("span",{children:[Object(Q.jsx)(Ee.a,{style:{color:"green",marginRight:15,fontSize:20},onClick:function(){return e.props.history.goBack()}}),Object(Q.jsxs)("span",{children:[" ",t?"edit product":" Add product","  "]})]}),a=[];return t&&("0"===n.pCategoryId||a.push(n.pCategoryId),a.push(n.categoryId)),Object(Q.jsx)(we.a,{title:r,children:Object(Q.jsxs)(T.a,Object(l.a)(Object(l.a)({},{labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:10}}}),{},{ref:this.formRef,children:[Object(Q.jsx)($e,{label:"Product name:",name:"name",initialValue:n.name,rules:[{required:!0,message:"Must enter product's name"}],children:Object(Q.jsx)(q.a,{placeholder:"Please enter product's name"})}),Object(Q.jsx)($e,{label:"Product description:",name:"desc",initialValue:n.desc,rules:[{required:!0,message:"Must enter product's description"}],children:Object(Q.jsx)(Ye,{placeholder:"Please enter product's describe",autoSize:{minRows:2,maxRows:6}})}),Object(Q.jsx)($e,{label:"Product price:",name:"price",initialValue:n.price,rules:[{required:!0,message:"Must enter product's price"},{validator:this.validatePrice}],children:Object(Q.jsx)(q.a,{type:"number",placeholder:"Please enter product's price",addonAfter:"CAD  "})}),Object(Q.jsx)($e,{label:"Product category",name:"categoryIds",initialValue:a,rules:[{required:!0,message:"\u5fc5\u987b\u6307\u5b9a\u5546\u54c1\u5206\u7c7b"}],children:Object(Q.jsx)(Fe.a,{options:et,loadData:this.loadData})}),Object(Q.jsx)($e,{label:"Product picture",children:Object(Q.jsx)(Ke,{ref:this.pw,imgs:n.imgs})}),Object(Q.jsx)($e,{label:"Product detail:",labelCol:{span:2},wrapperCol:{span:15},children:Object(Q.jsx)(Ze,{ref:this.editor,detail:n.detail})}),Object(Q.jsx)($e,{children:Object(Q.jsx)(_.a,{type:"primary",onClick:this.submit,children:"submit"})})]}))})}}]),n}(r.Component),nt=(n(942),n(247)),rt=nt.b.Item,at=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={cName1:"",cName2:""},e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){var e=Object(M.a)(F.a.mark((function e(){var t,n,r,a,s,c,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state.product,n=t.pCategoryId,r=t.categoryId,0!==n){e.next=9;break}return e.next=4,H.reqCategory(n);case 4:a=e.sent,s=a.data.name,this.setState({cName1:s}),e.next=15;break;case 9:return e.next=11,Promise.all([H.reqCategory(n),H.reqCategory(r)]);case 11:c=e.sent,i=c[0].data.name,o=c[1].data.name,this.setState({cName1:i,cName2:o});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state.product,n=t.name,r=t.desc,a=t.price,s=t.detail,c=t.imgs,i=this.state,o=i.cName1,u=i.cName2,l=Object(Q.jsxs)("span",{children:[Object(Q.jsx)(Ee.a,{style:{color:"green",marginRight:15,fontSize:20},onClick:function(){return e.props.history.goBack()}}),"Product detail"]});return Object(Q.jsxs)(we.a,{title:l,className:"product-detail",children:[Object(Q.jsx)(nt.b,{children:Object(Q.jsxs)(rt,{children:[Object(Q.jsx)("span",{className:"left",children:" Product name: "}),Object(Q.jsxs)("span",{children:[" ",n," "]})]})}),Object(Q.jsxs)(nt.b,{children:[Object(Q.jsxs)(rt,{children:[Object(Q.jsx)("span",{className:"left",children:" Product describe: "}),Object(Q.jsxs)("span",{children:["  ",r]})]}),Object(Q.jsxs)(rt,{children:[Object(Q.jsx)("span",{className:"left",children:" Product price: "}),Object(Q.jsxs)("span",{children:[" ",a," yuan "]})]}),Object(Q.jsxs)(rt,{children:[Object(Q.jsx)("span",{className:"left",children:" Product category: "}),Object(Q.jsxs)("span",{children:[" ",o," ",u?"--\x3e"+u:""," ",u," "]})]}),Object(Q.jsxs)(rt,{children:[Object(Q.jsx)("span",{className:"left",children:" Product picture: "}),Object(Q.jsx)("span",{children:c.map((function(e){return Object(Q.jsx)("img",{className:"product-imgs",src:Te+e,alt:"img"},e)}))})]}),Object(Q.jsxs)(rt,{children:[Object(Q.jsx)("span",{className:"left",children:" Product detail: "}),Object(Q.jsx)("span",{dangerouslySetInnerHTML:{__html:s}})]})]})]})}}]),n}(r.Component),st=(n(944),function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return Object(Q.jsx)("div",{children:Object(Q.jsxs)(P.d,{children:[Object(Q.jsx)(P.b,{path:"/product",component:Ue,exact:!0})," ",Object(Q.jsx)(P.b,{path:"/product/addupdate",component:tt}),Object(Q.jsx)(P.b,{path:"/product/detail",component:at}),Object(Q.jsx)(P.a,{to:"/product"})]})})}}]),n}(r.Component)),ct=T.a.Item,it=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).formRef=a.a.createRef(),e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.props.setForm(this.formRef.current)}},{key:"render",value:function(){return Object(Q.jsx)(T.a,{ref:this.formRef,children:Object(Q.jsx)(ct,{name:"roleName",rules:[{required:!0,message:"Role name required"}],label:"Role Name:",children:Object(Q.jsx)(q.a,{placeholder:"Please enter role name"})})})}}]),n}(r.Component),ot=(n(945),n(410)),ut=T.a.Item,lt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(e){var r;Object(S.a)(this,n),(r=t.call(this,e)).getMenus=function(){return r.state.checkedKeys},r.onCheck=function(e,t){r.setState({checkedKeys:e})};var a=r.props.role.menus;return r.state={checkedKeys:a},r}return Object(C.a)(n,[{key:"getTreeNodes",value:function(e){var t=this;return e.reduce((function(e,n){return e.push({title:n.title,key:n.key,children:n.children?t.getTreeNodes(n.children):null}),e}),[])}},{key:"UNSAFE_componentWillMount",value:function(){this.treeNodes=this.getTreeNodes(de)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){console.log("AuthRole");var e=this.props.role,t=this.state.checkedKeys;return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(ut,{label:"Role Name",children:Object(Q.jsx)(q.a,{value:e.name,disabled:!0})}),Object(Q.jsx)(ot.a,{checkable:!0,defaultExpandAll:!0,treeData:this.treeNodes,checkedKeys:t,onCheck:this.onCheck})]})}}]),n}(r.PureComponent),dt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(e){var r;return Object(S.a)(this,n),(r=t.call(this,e)).state={roles:[],role:{},isShowAdd:!1,isShowAuth:!1},r.initColumn=function(){r.columns=[{title:"Role Name",dataIndex:"name"},{title:"Create_Time",dataIndex:"create_time",render:function(e){return ge(e)}},{title:"Auth_Time",dataIndex:"auth_time",render:function(e){return ge(e)}},{title:"Auth_Name",dataIndex:"auth_name"}]},r.getRoles=Object(M.a)(F.a.mark((function e(){var t,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.reqRoles();case 2:0===(t=e.sent).status&&(n=t.data,r.setState({roles:n}));case 4:case"end":return e.stop()}}),e)}))),r.onRow=function(e){return{onClick:function(t){r.setState({role:e})}}},r.addRole=Object(M.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.form.validateFields().then(function(){var e=Object(M.a)(F.a.mark((function e(t){var n,a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({isShowAdd:!1}),n=t.roleName,r.form.resetFields(),e.next=5,H.reqAddRole(n);case 5:0===(a=e.sent).status&&(L.b.success("role created successfully"),s=a.data,r.setState((function(e){return{roles:[].concat(Object(Me.a)(e.roles),[s])}})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){L.b.info("fail to create role")}));case 1:case"end":return e.stop()}}),e)}))),r.updateRole=Object(M.a)(F.a.mark((function e(){var t,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({isShowAuth:!1}),t=r.state.role,n=r.auth.current.getMenus(),t.menus=n,t.auth_time=Date.now(),t.auth_name=r.props.user.username,e.next=8,H.reqUpdateRole(t);case 8:0===e.sent.status&&(t._id===r.props.user.role_id?(r.props.logout(),L.b.success("The current user role permission is changed. Log in again")):(L.b.success("The role permission is set successfully"),r.getRoles()));case 10:case"end":return e.stop()}}),e)}))),r.auth=a.a.createRef(),r}return Object(C.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumn()}},{key:"componentDidMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,n=t.roles,r=t.role,a=t.isShowAdd,s=t.isShowAuth,c=Object(Q.jsxs)("span",{children:[Object(Q.jsx)(_.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})},children:"Create Role"}),"\xa0\xa0",Object(Q.jsx)(_.a,{type:"primary",disabled:!r._id,onClick:function(){return e.setState({isShowAuth:!0})},children:"Setting Role Authority"})]});return Object(Q.jsxs)(we.a,{title:c,children:[Object(Q.jsx)(ke.a,{bordered:!0,rowKey:"_id",rowSelection:{type:"radio",selectedRowKeys:[r._id],onSelect:function(t){e.setState({role:t})}},dataSource:n,columns:this.columns,pagination:{defaultPageSize:3},onRow:this.onRow}),Object(Q.jsx)(me.a,{title:"Create Role",visible:a,onOk:this.addRole,onCancel:function(){e.setState({isShowAdd:!1}),e.form.resetFields()},children:Object(Q.jsx)(it,{setForm:function(t){return e.form=t}})}),Object(Q.jsx)(me.a,{title:"Setting Role Authority",visible:s,onOk:this.updateRole,onCancel:function(){e.setState({isShowAuth:!1})},children:Object(Q.jsx)(lt,{role:r,ref:this.auth})})]})}}]),n}(r.Component),pt=Object(i.b)((function(e){return{user:e.user}}),{logout:X})(dt),ht=n(137),jt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={sales:[5,20,36,10,10,20],Storage:[6,10,36,8,7,28]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),Storage:e.Storage.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"ECharts exemple"},tooltip:{},legend:{data:["Sales","Storage"]},xAxis:{data:["Shirt","Woollen Sweater","Blouse","Trousers","High-heeled Shoes","Socks"]},yAxis:{},series:[{name:"Sales",type:"bar",data:e},{name:"Storage",type:"bar",data:t}]}},e}return Object(C.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.sales,r=t.Storage;return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(we.a,{children:Object(Q.jsx)(_.a,{onClick:function(){return e.update()},type:"primary",children:"update"})}),Object(Q.jsx)(we.a,{title:"Bar chart",children:Object(Q.jsx)(ht.a,{style:{height:"300px"},option:this.getOption(n,r)})})]})}}]),n}(r.Component),mt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={sales:[5,20,36,10,10,20],Storage:[6,10,36,8,7,28]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),Storage:e.Storage.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"ECharts Example"},tooltip:{},legend:{data:["Sales","Storage"]},xAxis:{data:["Shirt","Woollen Sweater","Blouse","Trousers","High-heeled Shoes","Socks"]},yAxis:{},series:[{name:"Sales",type:"line",data:e},{name:"Storage",type:"line",data:t}]}},e}return Object(C.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.sales,r=t.Storage;return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(we.a,{children:Object(Q.jsx)(_.a,{onClick:function(){return e.update()},type:"primary",children:"update"})}),Object(Q.jsx)(we.a,{title:"Line chart",children:Object(Q.jsx)(ht.a,{style:{height:"300px"},option:this.getOption(n,r)})})]})}}]),n}(r.Component),bt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={sales:[5,20,36,10,10,20],Storage:[6,10,36,8,7,28]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),Storage:e.Storage.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(){return{series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",data:[{value:235,name:"Video Advertisement"},{value:274,name:"AD Network"},{value:310,name:" Email Marketing"},{value:335,name:"Direct Access"},{value:400,name:"Search Engine"}]}]}},e.getOption2=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"Direct Access"},{value:310,name:"Email Marketing"},{value:274,name:"AD Network"},{value:235,name:"Video Advertisement"},{value:400,name:"Search Engine"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},e}return Object(C.a)(n,[{key:"render",value:function(){var e=this.state;e.sales,e.Storage;return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(we.a,{title:"Pie1",children:Object(Q.jsx)(ht.a,Object(E.a)({style:{height:"300px"},option:this.getOption()},"style",{height:300}))}),Object(Q.jsx)(we.a,{title:"Pie2",children:Object(Q.jsx)(ht.a,Object(E.a)({style:{height:"300px"},option:this.getOption2()},"style",{height:300}))})]})}}]),n}(r.Component),ft=T.a.Item,Ot=Ne.a.Option,gt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).formRef=a.a.createRef(),e}return Object(C.a)(n,[{key:"componentDidMount",value:function(){this.props.setForm(this.formRef.current)}},{key:"render",value:function(){var e=this.props.roles,t=this.props.user||{};return Object(Q.jsxs)(T.a,{ref:this.formRef,labelCol:{span:4},wrapperCol:{span:14},children:[Object(Q.jsx)(ft,{label:"username",name:"username",initialValue:t.username,rules:[{required:!0,message:"username required"}],children:Object(Q.jsx)(q.a,{placeholder:"Please enter username"})}),t._id?null:Object(Q.jsx)(ft,{label:"passward",name:"password",initialValue:t.password,rules:[{required:!0,message:"password required"},{min:4,max:12}],children:Object(Q.jsx)(q.a,{type:"password",placeholder:"Password must be at least 4 characters"})}),Object(Q.jsx)(ft,{label:"phone",name:"phone",initialValue:t.phone,rules:[{required:!0,message:"phone number required"}],children:Object(Q.jsx)(q.a,{placeholder:"please enter phone number"})}),Object(Q.jsx)(ft,{label:"email",name:"email",initialValue:t.email,rules:[{required:!0,message:"email required"}],children:Object(Q.jsx)(q.a,{placeholder:"please enter email"})}),Object(Q.jsx)(ft,{label:"role",name:"role_id",initialValue:t.role_id,children:Object(Q.jsx)(Ne.a,{placeholder:"please choose role",children:e.map((function(e){return Object(Q.jsx)(Ot,{value:e._id,children:e.name},e._id)}))})})]})}}]),n}(r.PureComponent),xt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={users:[],roles:[],isShow:!1},e.initColumns=function(){e.columns=[{title:"Username",dataIndex:"username"},{title:"Email",dataIndex:"email"},{title:"Phone",dataIndex:"phone"},{title:"Create_time",dataIndex:"create_time",render:ge},{title:"Role_id",dataIndex:"role_id",render:function(t){return e.roleNames[t]}},{title:"Management",render:function(t){return Object(Q.jsxs)("span",{children:[Object(Q.jsx)(Oe,{onClick:function(){return e.showUpdate(t)},children:"update"}),Object(Q.jsx)(Oe,{onClick:function(){return e.deleteUser(t)},children:"delete"})]})}}]},e.initRoleNames=function(t){var n=t.reduce((function(e,t){return e[t._id]=t.name,e}),{});e.roleNames=n},e.deleteUser=function(t){me.a.confirm({title:"Confirm delete ".concat(t.username),icon:Object(Q.jsx)(be.a,{}),onOk:function(){var n=Object(M.a)(F.a.mark((function n(){return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H.reqDeleteUser(t._id);case 2:0===n.sent.status&&(L.b.success("delete user successfully"),e.getUsers());case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()})},e.showUpdate=function(t){e.user=t,e.setState({isShow:!0})},e.showAdd=function(){e.user=null,e.setState({isShow:!0})},e.addOrUpdateUser=function(){e.form.validateFields().then(function(){var t=Object(M.a)(F.a.mark((function t(n){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isShow:!1}),e.form.resetFields(),e.user&&(n._id=e.user._id),t.next=5,H.reqAddOrUpdateUser(n);case 5:0===t.sent.status&&(L.b.success("".concat(e.user?"\u4fee\u6539":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f")),e.getUsers());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.getUsers=Object(M.a)(F.a.mark((function t(){var n,r,a,s;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.reqUsers();case 2:0===(n=t.sent).status&&(r=n.data,a=r.users,s=r.roles,e.initRoleNames(s),e.setState({users:a,roles:s}));case 4:case"end":return t.stop()}}),t)}))),e}return Object(C.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this,t=Object(Q.jsx)(_.a,{type:"primary",onClick:function(){return e.showAdd()},children:"Create User"}),n=this.state,r=n.users,a=n.isShow,s=n.roles,c=this.user||{};return Object(Q.jsxs)(we.a,{title:t,children:[Object(Q.jsx)(ke.a,{dataSource:r,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{defaultPageSize:3,showQuickJumper:!0}}),";",Object(Q.jsx)(me.a,{title:c._id?"update user":"create user",visible:a,onOk:this.addOrUpdateUser,onCancel:function(){e.setState({isShow:!1}),e.form.resetFields()},destroyOnClose:!0,children:Object(Q.jsx)(gt,{setForm:function(t){return e.form=t},roles:s,user:this.user})})]})}}]),n}(r.Component),yt=(n(309),n(125)),vt=(n(310),n(69)),wt=(n(952),function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(S.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).goHome=function(){e.props.setHeadTitle("\u9996\u9875"),e.props.history.replace("/home")},e}return Object(C.a)(n,[{key:"render",value:function(){return Object(Q.jsxs)(yt.a,{className:"not-found",children:[Object(Q.jsx)(vt.a,{span:0,className:"left"}),Object(Q.jsxs)(vt.a,{span:24,className:"right",children:[Object(Q.jsx)("h1",{children:"404"}),Object(Q.jsx)("h2",{children:"Page not found"}),Object(Q.jsx)("div",{children:Object(Q.jsx)(_.a,{type:"primary",onClick:this.goHome,children:"Back to home"})})]})]})}}]),n}(r.Component)),kt=Object(i.b)(null,{setHeadTitle:J})(wt),St=Y.a.Footer,Ct=Y.a.Sider,Nt=Y.a.Content,It=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){var e=this.props.user;return e&&e._id?Object(Q.jsxs)(Y.a,{style:{minHeight:"100%"},children:[Object(Q.jsx)(Ct,{children:Object(Q.jsx)(je,{})}),Object(Q.jsxs)(Y.a,{children:[Object(Q.jsx)(ye,{children:"Header"}),Object(Q.jsx)(Nt,{style:{margin:20,backgroundColor:"#fff"},children:Object(Q.jsxs)(P.d,{children:[Object(Q.jsx)(P.a,{exact:!0,from:"/",to:"/home"}),Object(Q.jsx)(P.b,{path:"/home",component:ve}),Object(Q.jsx)(P.b,{path:"/category",component:_e}),Object(Q.jsx)(P.b,{path:"/product",component:st}),Object(Q.jsx)(P.b,{path:"/role",component:pt}),Object(Q.jsx)(P.b,{path:"/user",component:xt}),Object(Q.jsx)(P.b,{path:"/charts/bar",component:jt}),Object(Q.jsx)(P.b,{path:"/charts/line",component:mt}),Object(Q.jsx)(P.b,{path:"/charts/pie",component:bt}),Object(Q.jsx)(P.b,{component:kt})," //\u4e0a\u9762\u6ca1\u6709\u4e00\u4e2a\u5339\u914d\u7684\uff0c\u76f4\u63a5\u663e\u793a"]})}),Object(Q.jsx)(St,{style:{textAlign:"center",color:"grey"},children:"Google Chrome is recommended for better page operation experience"})]})]}):Object(Q.jsx)(P.a,{to:"/login"})}}]),n}(r.Component),At=Object(i.b)((function(e){return{user:e.user}}),{})(It),Pt=function(e){Object(N.a)(n,e);var t=Object(I.a)(n);function n(){return Object(S.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"render",value:function(){return Object(Q.jsx)(A.a,{children:Object(Q.jsxs)(P.d,{children:[Object(Q.jsx)(P.b,{path:"/login",component:$}),Object(Q.jsx)(P.b,{path:"/",component:At})]})})}}]),n}(r.Component);c.a.render(Object(Q.jsxs)(i.a,{store:k,children:[" ",Object(Q.jsx)(Pt,{})]}),document.getElementById("root"))}},[[953,1,2]]]);
//# sourceMappingURL=main.8c8b2891.chunk.js.map